
Imprime os dados lidos da lading:
+--------+--------+--------+-----+------+--------+--------+
|practice|bnf_code|bnf_name|items|   nic|act_cost|quantity|
+--------+--------+--------+-----+------+--------+--------+
|    1596|   13320|   22721|    1|  3.64|    3.38|     112|
|    1596|   20494|     263|    1|  1.25|    1.27|      42|
|    1596|   19136|   17446|    1|  0.56|    0.63|      14|
|    1596|   17512|   16983|    3|  1.95|    2.04|      49|
|    1596|    2653|   12675|    2|  2.28|    2.34|      84|
|    1596|   12551|    1282|    1|  0.71|    0.77|      42|
|    1596|   27926|   17643|    1| 39.67|   36.84|      14|
|    1596|   12518|   12939|    1|211.12|  195.56|      56|
|    1596|    1674|   23525|    2|  3.52|    3.28|      56|
|    1596|    8979|   18703|    1| 13.06|    12.1|     150|
|    1596|   25364|    2839|    1|  0.53|     0.6|      14|
|    1596|    5312|    2870|    1|  2.25|     2.2|      56|
|    1596|    2885|    1851|    1|  0.15|    0.25|       5|
|    1596|   24948|    8574|    1|  0.35|    0.44|       5|
|    1596|    5737|   10645|    3|  2.27|    2.34|      56|
|    1596|    7842|   15769|    1| 27.72|   25.67|      28|
|    1596|   19036|   18533|    1| 17.45|   16.27|      28|
|    1596|   24523|    7372|    4|  6.84|    6.48|     119|
|    1596|    5616|   21543|    1|  0.34|    0.43|       7|
|    1596|   22227|    5860|    2|  2.98|    2.98|      14|
+--------+--------+--------+-----+------+--------+--------+
only showing top 20 rows

None

Imprime o schema do dataframe lido da landing:
root
 |-- practice: integer (nullable = true)
 |-- bnf_code: integer (nullable = true)
 |-- bnf_name: integer (nullable = true)
 |-- items: integer (nullable = true)
 |-- nic: double (nullable = true)
 |-- act_cost: double (nullable = true)
 |-- quantity: integer (nullable = true)

None
+--------+--------+--------+-----+------+--------+--------+
|practice|bnf_code|bnf_name|items|   nic|act_cost|quantity|
+--------+--------+--------+-----+------+--------+--------+
|    1596|   13320|   22721|    1|  3.64|    3.38|     112|
|    1596|   20494|     263|    1|  1.25|    1.27|      42|
|    1596|   19136|   17446|    1|  0.56|    0.63|      14|
|    1596|   17512|   16983|    3|  1.95|    2.04|      49|
|    1596|    2653|   12675|    2|  2.28|    2.34|      84|
|    1596|   12551|    1282|    1|  0.71|    0.77|      42|
|    1596|   27926|   17643|    1| 39.67|   36.84|      14|
|    1596|   12518|   12939|    1|211.12|  195.56|      56|
|    1596|    1674|   23525|    2|  3.52|    3.28|      56|
|    1596|    8979|   18703|    1| 13.06|    12.1|     150|
|    1596|   25364|    2839|    1|  0.53|     0.6|      14|
|    1596|    5312|    2870|    1|  2.25|     2.2|      56|
|    1596|    2885|    1851|    1|  0.15|    0.25|       5|
|    1596|   24948|    8574|    1|  0.35|    0.44|       5|
|    1596|    5737|   10645|    3|  2.27|    2.34|      56|
|    1596|    7842|   15769|    1| 27.72|   25.67|      28|
|    1596|   19036|   18533|    1| 17.45|   16.27|      28|
|    1596|   24523|    7372|    4|  6.84|    6.48|     119|
|    1596|    5616|   21543|    1|  0.34|    0.43|       7|
|    1596|   22227|    5860|    2|  2.98|    2.98|      14|
+--------+--------+--------+-----+------+--------+--------+
only showing top 20 rows


Escrevendo os dados lidos da raw para parquet na processing zone...

Imprime os dados lidos em parquet da processing zone
+--------+--------+--------+-----+-----+--------+--------+
|practice|bnf_code|bnf_name|items|  nic|act_cost|quantity|
+--------+--------+--------+-----+-----+--------+--------+
|    5668|   11426|   10363|    1| 8.12|    7.54|      30|
|    1596|     115|   21365|    1| 2.25|     2.2|      42|
|    1596|   17512|   16983|    3| 1.12|    1.37|      28|
|    1596|    2653|   12675|    2| 1.52|    1.43|      56|
|    1596|   18938|   10575|    1| 0.38|    0.46|      14|
|    1596|   17538|   21333|    1| 0.28|    0.37|       7|
|    1596|   24657|    6664|    1| 0.48|    0.56|      14|
|    1596|   27926|   17643|    2| 59.5|   55.39|      21|
|    1596|    9903|    3775|    1| 13.2|   12.35|       7|
|    1596|    1674|   23525|    1| 0.88|    0.93|      14|
|    1596|   19026|   14257|    1| 1.68|    1.67|      28|
|    1596|    8979|   18703|    2|25.19|   23.48|     290|
|    1596|    9148|    3381|    1| 0.48|    0.56|      14|
|    1596|       4|   22802|    1| 0.46|    0.54|      14|
|    1596|    6036|   12426|    1| 0.87|    0.82|      28|
|    1596|    5312|    2870|    2| 1.69|    1.79|      42|
|    1596|    5008|   15013|    1| 0.77|    0.83|      28|
|    1596|   19102|   20819|    3|106.2|    98.6|     126|
|    1596|    6719|   21584|    1|  0.2|     0.3|       7|
|    1596|    5737|   10645|    7| 5.39|    5.68|     133|
+--------+--------+--------+-----+-----+--------+--------+
only showing top 20 rows

None

Criando sq View
+--------+------------------+-------------+----------+------------------+
|Bnf_code|         Soma_cost|Soma_Quantity|Soma_items|        Media_cost|
+--------+------------------+-------------+----------+------------------+
|   10206|          61133.12|      3557400|      4543|18.775528255528258|
|   24663|           4470.43|        19807|       499|       13.97009375|
|   10362|           4651.62|          170|       103| 47.95484536082474|
|   13289|307316.02999999997|       153530|     11308|  76.2760064532142|
|    4101|4734.7699999999995|         1965|       165|31.356092715231785|
|   26087|            5014.5|         4323|       219|28.654285714285713|
|   26623|1954.0000000000002|          672|       483|13.026666666666669|
|   11317| 7576.949999999999|         2490|        53|           151.539|
|    1088|11860.410000000002|         3012|       244| 60.51229591836736|
|   16339|           1456.35|        21140|       121| 13.12027027027027|
|   11141| 84773.58999999998|        68229|       809|128.25051437216337|
|    2122|          20017.99|         8120|        99|244.12182926829271|
|    6357| 644.3199999999999|           67|        46|17.414054054054052|
|   10817|            3591.3|          549|        38|108.82727272727273|
|   12046|          30311.63|         1943|       130|319.06978947368424|
|   27760|          30002.75|        48610|       313|123.97830578512396|
|   24171|2652.0800000000004|       118719|        97|            33.151|
|   16503|2862.2000000000003|           59|        36| 92.32903225806453|
|    9852|1485.1100000000001|          930|        22| 74.25550000000001|
|    9465|           5137.92|         1830|        39|155.69454545454545|
+--------+------------------+-------------+----------+------------------+
only showing top 20 rows

None

Escrevendo os dados processados na Curated Zone...

Lendo os dados processados na Curated Zone...
+--------+------------------+-------------+----------+------------------+
|Bnf_code|         Soma_cost|Soma_Quantity|Soma_items|        Media_cost|
+--------+------------------+-------------+----------+------------------+
|   13289|307316.02999999997|       153530|     11308|  76.2760064532142|
|    1088|11860.410000000002|         3012|       244| 60.51229591836736|
|   16339|1456.3500000000001|        21140|       121|13.120270270270272|
|   10206| 61133.12000000001|      3557400|      4543|18.775528255528258|
|    1342|            133.53|            1|         1|            133.53|
|   27760|30002.749999999996|        48610|       313|123.97830578512395|
|     833|10017.140000000003|           68|        68|151.77484848484852|
|   11141|          84773.59|        68229|       809| 128.2505143721634|
|    2122|20017.989999999998|         8120|        99|244.12182926829266|
|   24663| 4470.430000000001|        19807|       499|13.970093750000004|
|   10362|           4651.62|          170|       103| 47.95484536082474|
|   24171|           2652.08|       118719|        97|33.150999999999996|
|   10623|12643.970000000001|        36700|       131|111.89353982300887|
|   11317|           7576.95|         2490|        53|           151.539|
|   20382| 660.1999999999999|           91|        56|12.696153846153845|
|   27974|16830.519999999997|        23450|        86| 243.9205797101449|
|   10817|            3591.3|          549|        38|108.82727272727273|
|   26087|            5014.5|         4323|       219|28.654285714285713|
|    9852|           1485.11|          930|        22|           74.2555|
|   12046|          30311.63|         1943|       130|319.06978947368424|
+--------+------------------+-------------+----------+------------------+
only showing top 20 rows

None
